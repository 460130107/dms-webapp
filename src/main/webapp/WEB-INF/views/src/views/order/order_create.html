<!--
	The ID "widget-grid" will start to initialize all widgets below 
	You do not need to use widgets if you dont want to. Simply remove 
	the <section></section> and you can use wells or panels instead 
	-->

<!-- widget grid -->
<section id="widget-grid" class="">

	<!-- row -->
	<div class="row">

		<!-- NEW WIDGET START -->
		<article class="col-xs-12 col-sm-12 col-md-12 col-lg-12">

			<!-- Widget ID (each widget will need unique ID)-->
			<div class="jarviswidget" id="wid-id-4">
				<!-- widget options:
                usage: <div class="jarviswidget" id="wid-id-0" data-widget-editbutton="false">

                data-widget-colorbutton="false"
                data-widget-editbutton="false"
                data-widget-togglebutton="false"
                data-widget-deletebutton="false"
                data-widget-fullscreenbutton="false"
                data-widget-custombutton="false"
                data-widget-collapsed="true"
                data-widget-sortable="false"

                -->
				<header>
					<span class="widget-icon"> <i class="fa fa-table"></i> </span>
					<h2>创建订单</h2>
				</header>
				<!-- widget div-->
				<div>
					<!-- widget edit box -->
					<div class="jarviswidget-editbox">
						<!-- This area used as dropdown edit box -->
					</div>
					<!-- end widget edit box -->
					<!-- widget content -->
					<div class="widget-body">
						<form class="form-horizontal" ug-validate="addOrderForm" name="addOrderForm" novalidate="">

							<fieldset class="demo-switcher-1">
								<legend>订单类型</legend>

								<div class="form-group">
									<label class="col-md-2 control-label">订单类型：</label>
									<div class="col-md-10">
										<label class="radio radio-inline">
											<!--	3-客服下单	-->
											<input type="hidden" ng-init="order.orderSource=3" ng-model="order.orderSource" name="orderSource">
											<input type="radio" class="radiobox" value="0" ng-model="order.orderType" ng-checked="order.orderType==0" name="orderType">
											<span>常规订单</span>
										</label>
										<label class="radio radio-inline">
											<input type="radio" class="radiobox" value="1" ng-model="order.orderType" ng-checked="order.orderType==1" name="orderType">
											<span>卡类订单</span>
										</label>
										<label class="radio radio-inline">
											<input type="radio" class="radiobox" value="2" ng-model="order.orderType" ng-checked="order.orderType==2" name="orderType">
											<span>券类订单</span>
										</label>
									</div>
								</div>

							</fieldset>


							<fieldset class="demo-switcher-1" >
								<legend>客户信息</legend>
								<div class="form-group" ng-if="order.orderType==1">
									<label class="control-label col-md-2">卡号</label>
									<div class="col-md-4">
										<div class="input-group input-group-md">
											<input type="text" ng-model="order.cardNumber" placeholder="卡号" class="form-control">
						                    <span class="input-group-btn">
						                        <button class="btn btn-default" type="button">查询</button>
						                    </span>
										</div>
									</div>
									<label class="control-label col-md-2">姓名</label>
									<div class="col-md-4">
										<input type="text" ng-model="order.name" disabled placeholder="查询后自动填充" class="form-control">
									</div>
								</div>
								<div class="form-group" ng-if="order.orderType==2">
									<label class="control-label col-md-2">券号</label>
									<div class="col-md-4">
										<div class="input-group input-group-md">
											<input type="text" ng-model="order.cardNumber" placeholder="券号" class="form-control">
						                    <span class="input-group-btn">
						                        <button class="btn btn-default" type="button">查询</button>
						                    </span>
										</div>
									</div>
									<label class="control-label col-md-2">使用状态</label>
									<div class="col-md-4">
										<label class="radio radio-inline">
											<input type="radio" class="radiobox" disabled value="0" ng-model="order.isUse" ng-checked="order.isUse==0" name="isUse">
											<span>已使用</span>
										</label>
										<label class="radio radio-inline">
											<input type="radio" class="radiobox" disabled value="1" ng-model="order.isUse" ng-checked="order.isUse==1" name="isUse">
											<span>未使用</span>
										</label>
									</div>
								</div>
								<div class="form-group" ng-if="order.orderType==0">
									<label class="control-label col-md-2">电话号码</label>
									<div class="col-md-4">
										<div class="input-group input-group-md">
											<input type="text" ng-model="order.phone" value="13162323157" placeholder="电话／手机号码" class="form-control">
						                    <span class="input-group-btn">
						                        <button class="btn btn-default" data-ng-click="queryMemberByPhoneNumber()" type="button">查询</button>
						                    </span>
										</div>
										<input ng-if="order.orderType!=0" disabled type="text" ng-model="order.phone" placeholder="电话／手机号码" class="form-control">
									</div>
									<label class="control-label col-md-2">姓名</label>
									<div class="col-md-4">
										<input type="text" ng-model="order.name" disabled placeholder="查询后自动填充" class="form-control">
									</div>
								</div>
								<div class="form-group" ng-if="order.orderType==1">
									<label class="control-label col-md-2">密码</label>
									<div class="col-md-4">
										<input type="text" ng-model="order.password" disabled placeholder="查询后自动填充" class="form-control">
									</div>
									<label class="control-label col-md-2">余额</label>
									<div class="col-md-4">
										<input type="text" ng-model="order.amount" disabled placeholder="查询后自动填充" class="form-control">
									</div>
								</div>
								<div class="form-group">
									<label class="control-label col-md-2">单位／个人</label>
									<div class="col-md-4">
										<input type="hidden" ng-model="order.companyCode" disabled class="form-control">
										<input type="text" ng-model="order.companyName" disabled placeholder="查询后自动填充" class="form-control">
									</div>
									<label class="control-label col-md-2">客户经理</label>
									<div class="col-md-4">
										<input type="hidden" ng-model="order.managerId" disabled class="form-control">
										<input type="text" ng-model="order.managerName" disabled placeholder="查询后自动填充" class="form-control">
									</div>
								</div>
								<div class="form-group">
									<label class="control-label col-md-2">默认收货人</label>
									<div class="col-md-4">
										<div class="input-group">
											<input type="text" ng-model="order.consigneeName" disabled placeholder="查询后自动填充" class="form-control">
											<span class="input-group-addon">
												<span class="onoffswitch">
													<input type="radio" name="start_interval" class="onoffswitch-checkbox" id="default_address">
													<label class="onoffswitch-label" for="default_address">
														<span class="onoffswitch-inner" data-swchon-text="启用" data-swchoff-text="禁用"></span>
														<span class="onoffswitch-switch"></span>
													</label>
												</span>
											</span>
										</div>
									</div>
									<label class="control-label col-md-2">联系方式</label>
									<div class="col-md-4">
										<input type="text" ng-model="order.consigneePhone" disabled placeholder="查询后自动填充" class="form-control">
									</div>
								</div>
								<div class="form-group">
									<label class="control-label col-md-2">收货地址</label>
									<div class="col-md-10">
										<input type="text" ng-model="order.consigneeAddress" disabled placeholder="查询后自动填充" class="form-control">
									</div>
								</div>

								<div class="form-group" ng-show="order.spareAddress">
									<label class="control-label col-md-2">备用收货人</label>
									<div class="col-md-4">
										<div class="input-group">
											<input type="text" disabled placeholder="查询后自动填充" class="form-control">
											<span class="input-group-addon">
												<span class="onoffswitch">
													<input type="radio" name="start_interval" class="onoffswitch-checkbox" id="backup_address">
													<label class="onoffswitch-label" for="backup_address">
														<span class="onoffswitch-inner" data-swchon-text="启用" data-swchoff-text="禁用"></span>
														<span class="onoffswitch-switch"></span>
													</label>
												</span>
											</span>
										</div>
									</div>
									<label class="control-label col-md-2">联系方式</label>
									<div class="col-md-4">
										<input type="text" disabled placeholder="查询后自动填充" class="form-control">
									</div>
								</div>
								<div class="form-group" ng-show="order.spareAddress">
									<label class="control-label col-md-2">收货地址</label>
									<div class="col-md-10">
										<input type="text" disabled placeholder="查询后自动填充" class="form-control">
									</div>
								</div>

								<div class="form-group" ng-show="order.spareAddress2">
									<label class="control-label col-md-2">备用收货人</label>
									<div class="col-md-4">
										<div class="input-group">
											<input type="text" disabled placeholder="查询后自动填充" class="form-control">
											<span class="input-group-addon">
												<span class="onoffswitch">
													<input type="radio" name="start_interval" class="onoffswitch-checkbox" id="backup_address2">
													<label class="onoffswitch-label" for="backup_address2">
														<span class="onoffswitch-inner" data-swchon-text="启用" data-swchoff-text="禁用"></span>
														<span class="onoffswitch-switch"></span>
													</label>
												</span>
											</span>
										</div>
									</div>
									<label class="control-label col-md-2">联系方式</label>
									<div class="col-md-4">
										<input type="text" disabled placeholder="查询后自动填充" class="form-control">
									</div>
								</div>
								<div class="form-group"  ng-show="order.spareAddress2">
									<label class="control-label col-md-2">收货地址</label>
									<div class="col-md-10">
										<input type="text" disabled placeholder="查询后自动填充" class="form-control">
									</div>
								</div>

								<div class="form-group">
									<label class="control-label col-md-2">客户要求</label>
									<div class="col-md-10">
										<input type="text" ng-model="order.remark" placeholder="周末送达，工作日送达" class="form-control">
									</div>
								</div>
							</fieldset>

							<fieldset class="demo-switcher-1">
								<legend>订购产品</legend>
								<div class="row">
									<div class="table-responsive col-md-6">

										<table class="table table-bordered">
											<thead>
											<tr>
												<th colspan="4">可选购产品</th>
											</tr>
											</thead>
											<thead>
											<tr>
												<th>名称</th>
												<th>规格</th>
												<th class="text-align-right">单价</th>
												<th>操作</th>
											</tr>
											</thead>
											<tbody>
											<tr data-ng-repeat="item in itemList">
												<td>{{item.itemName}}</td>
												<td>{{item.spec}}</td>
												<td class="text-align-right">{{item.sellPrice | number:2}}</td>
												<td>
													<div>
														<a href="javascript:void(0);" data-ng-click="openItemNumber($index)" title="订购：{{item.itemName}}">
															<span class="fa fa-plus"></span>
														</a>
													</div>
												</td>
											</tr>
											</tbody>
											<tfoot>
											<tr>
												<td colspan="4">
													<ug-pagination page-info="pageInfoSetting" ></ug-pagination>
												</td>
											</tr>
											</tfoot>
										</table>

									</div>
									<div class="table-responsive col-md-6">
										<input type="hidden" ng-model="order.orderItemList" name="orderItemList">
										<table class="table table-bordered">
											<thead>
											<tr>
												<th colspan="5">已选购产品</th>
											</tr>
											<tr>
												<th>名称</th>
												<th class="text-align-right">单价</th>
												<th class="text-align-right">份数</th>
												<th class="text-align-right">总价</th>
												<th>操作</th>
											</tr>
											</thead>
											<tbody>
												<tr ng-repeat="choseItem in choseOrderItemList">
													<td>{{choseItem.itemName}}</td>
													<td class="text-align-right">{{choseItem.sellPrice | number:2}}</td>
													<td class="text-align-right">{{choseItem.itemQty | number:2}}</td>
													<td class="text-align-right">{{choseItem.sellPrice * choseItem.itemQty | number:2}}</td>
													<td>
														<div>
															<a href="javascript:void(0);" data-ng-click="removeItem($index)" title="移除：{{choseItem.itemName}}">
																<span class="glyphicon glyphicon-trash"></span>
															</a>
															<!--<a href="javascript:void(0);" data-ng-click="changeItemNumber($index, 1)" title="添加：{{choseItem.itemName}}">-->
																<!--<span class="fa fa-plus"></span>-->
															<!--</a>-->
															<!--<a  ng-if="choseItem.itemQty > 1" href="javascript:void(0);" data-ng-click="changeItemNumber($index, 0)" title="减少：{{choseItem.itemName}}">-->
																<!--<span class="fa fa-minus"></span>-->
															<!--</a>-->
														</div>
													</td>
												</tr>
											</tbody>
											<tfoot>
											<tr>
												<td colspan="2">合计</td>
												<td class="text-align-right">{{totalItem.totalNumber | number:2}}</td>
												<td class="text-align-right">{{totalItem.totalPrice | number:2}}</td>
												<td>
													<div>
														<a ng-if="choseOrderItemList.length > 0" href="javascript:void(0);" data-ng-click="removeAllItem()" title="移除所有：{{choseItem.itemName}}">
															<span class="glyphicon glyphicon-trash"></span>
														</a>
													</div>
												</td>
											</tr>
											</tfoot>
										</table>
									</div>
								</div>
							</fieldset>

							<fieldset class="demo-switcher-1">
								<legend>订单金额</legend>
								<div class="form-group">
									<label class="control-label col-md-2">订单总金额</label>
									<div class="col-md-4">
										<input type="text" disabled placeholder="由系统自动计算" class="form-control">
									</div>
									<label class="col-md-2 control-label">订单折后总金额</label>
									<div class="col-md-4">
										<input type="text" disabled placeholder="由系统自动计算" class="form-control">
									</div>
								</div>
								<div class="form-group">
									<label class="control-label col-md-2">折扣</label>
									<div class="col-md-4">
										<input type="text" ng-model="order.discount" placeholder="折扣百分比" class="form-control">
									</div>
									<label class="col-md-2 control-label">显示订单金额</label>
									<div class="col-md-2">
										<div class="checkbox">
											<label>
												<input type="checkbox" ng-model="order.isShowAmount" class="checkbox style-0" name="isShowAmount" checked="checked" ng-true-value="0" ng-false-value="1">
												<span>显示</span>
											</label>
										</div>
									</div>
								</div>

							</fieldset>


							<fieldset class="demo-switcher-1">
								<legend>付款方式</legend>
								<div class="form-group">
									<label class="control-label col-md-2">付款方式</label>
									<div class="col-md-10">
										<label class="radio radio-inline">
											<input type="radio" required class="radiobox" value="0" ng-model="order.paymentMode" ng-checked="order.paymentMode==0" name="paymentMode">
											<span>回馈</span>
										</label>
										<label class="radio radio-inline">
											<input type="radio" required class="radiobox" value="1" ng-model="order.paymentMode" ng-checked="order.paymentMode==1" name="paymentMode">
											<span>客户经理代收</span>
										</label>
										<label class="radio radio-inline">
											<input type="radio" required class="radiobox" value="2" ng-model="order.paymentMode" ng-checked="order.paymentMode==2" name="paymentMode">
											<span>刷POS</span>
										</label>
										<label class="radio radio-inline">
											<input type="radio" required class="radiobox" value="3" ng-model="order.paymentMode" ng-checked="order.paymentMode==3" name="paymentMode">
											<span>转账</span>
										</label>
										<label class="radio radio-inline">
											<input type="radio" required class="radiobox" value="4" ng-model="order.paymentMode" ng-checked="order.paymentMode==4" name="paymentMode">
											<span>物流公司代收</span>
										</label>
										<label class="radio radio-inline">
											<input type="radio" required class="radiobox" value="5" ng-model="order.paymentMode" ng-checked="order.paymentMode==5" name="paymentMode">
											<span>卡类扣款</span>
										</label>
										<label class="radio radio-inline">
											<input type="radio" required class="radiobox" value="6" ng-model="order.paymentMode" ng-checked="order.paymentMode==6" name="paymentMode">
											<span>其它</span>
										</label>
									</div>
								</div>
							</fieldset>

							<fieldset class="demo-switcher-1">
								<legend>订单快照</legend>
								<div class="form-group">
									<div class="col-md-12">
										<label class="control-label col-md-2">客户姓名：</label>
										<div class="col-md-4">
											<label class="control-label" ng-bind="order.name"></label>
										</div>
									</div>
									<div class="col-md-12">
										<label class="control-label col-md-2">客户联系方式：</label>
										<div class="col-md-4">
											<label class="control-label" ng-bind="order.phone"></label>
										</div>
									</div>
									<div class="col-md-12">
										<label class="control-label col-md-2">收货人：</label>
										<div class="col-md-4">
											<label class="control-label" ng-bind="order.consigneeName"></label>
										</div>
									</div>
									<div class="col-md-12">
										<label class="control-label col-md-2">收货人联系方式：</label>
										<div class="col-md-4">
											<label class="control-label" ng-bind="order.consigneePhone"></label>
										</div>
									</div>
									<div class="col-md-12">
										<label class="control-label col-md-2">收货人联系方式：</label>
										<div class="col-md-10">
											<label class="control-label" ng-bind="order.consigneeAddress"></label>
										</div>
									</div>
									<div class="col-md-12">
										<label class="control-label col-md-2">付款方式：</label>
										<div class="col-md-10">
											<label class="control-label" ng-bind="order.paymentMode">回馈</label>
										</div>
									</div>
									<div class="col-md-12">
										<label class="control-label col-md-2" ng-if="order.remark">客户要求：</label>
										<div class="col-md-10" ng-if="order.remark">
											<label class="control-label" ng-bind="order.remark"></label>
										</div>
									</div>
									<div class="col-md-12">
										<label class="control-label col-md-2">订购产品详情：</label>
										<div class="table-responsive col-md-6" style="padding-top: 10px;">
											<table class="table table-bordered">
												<thead>
												<tr>
													<th colspan="4">已选购产品</th>
												</tr>
												<tr>
													<th>名称</th>
													<th class="text-align-right">单价</th>
													<th class="text-align-right">份数</th>
													<th class="text-align-right">总价</th>
												</tr>
												</thead>
												<tbody>
												<tr ng-repeat="choseItem in choseOrderItemList">
													<td>{{choseItem.itemName}}</td>
													<td class="text-align-right">{{choseItem.sellPrice | number:2}}</td>
													<td class="text-align-right">{{choseItem.itemQty | number:2}}</td>
													<td class="text-align-right">{{choseItem.sellPrice * choseItem.itemQty | number:2}}</td>
												</tr>
												</tbody>
												<tfoot>
												<tr>
													<td colspan="2">合计</td>
													<td class="text-align-right">{{totalItem.totalNumber | number:2}}</td>
													<td class="text-align-right">{{totalItem.totalPrice | number:2}}</td>
												</tr>
												</tfoot>
											</table>
										</div>
									</div>
								</div>
							</fieldset>

							<div class="form-actions">
								<div class="row">
									<div class="col-md-12">
										<button class="btn btn-default" type="button">
											取消
										</button>
										<button class="btn btn-primary" data-ng-click="saveOrder()" type="button">
											<i class="fa fa-save"></i>
											提交
										</button>
									</div>
								</div>
							</div>

						</form>
					</div>
					<!-- end widget content -->
				</div>
				<!-- end widget div -->
			</div>
			<!-- end widget -->

		</article>
		<!-- WIDGET END -->

	</div>

	<!-- end row -->

</section>
<!-- end widget grid -->

<script type="text/ng-template" id="addItemNumber.html">
	<div class="modal-header">
		<h3 class="modal-title">订购【{{orderItem.itemName}}】</h3>
	</div>
	<div class="modal-body">
		<div class="widget-body">

			<form class="form-horizontal" ug-validate="addItemNumberForm" name="addItemNumberForm" novalidate="">

				<fieldset>

					<div class="form-group">
						<label class="col-md-2 control-label">订购数量</label>
						<div class="col-md-10 input-group">
							<input class="form-control" required data-rule-number="true" ng-model="orderItem.number" name="number" placeholder="产品订购数量" type="text">
						</div>
					</div>

					<div class="form-group" ng-if="errors">
						<label class="col-md-2 control-label"></label>
						<div class="col-md-10 error">
							{{errors.message}}
						</div>
					</div>
				</fieldset>
			</form>
		</div>
	</div>
	<div class="modal-footer">
		<button class="btn btn-primary" type="submit" data-ng-click="saveItemNumber()">
			<i class="fa fa-save"></i>
			确定
		</button>
		<button class="btn btn-warning" ng-click="cancel()">取消</button>
	</div>
</script>